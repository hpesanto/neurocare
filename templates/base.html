<!doctype html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  {% load static %}
  <title>{% block title %}NeuroCare{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/base.css' %}{% if static_version %}?v={{ static_version }}{% endif %}">
  <link rel="stylesheet" href="{% static 'css/menu.css' %}{% if static_version %}?v={{ static_version }}{% endif %}">
</head>

<body>
  <header>
    <div class="brand">
      {# Link para a home. Se não existir a URL nomeada 'home', use '/' como fallback. #}
      <a class="brand-link" href="{% url 'home' %}">
        <img src="{% static 'images/logo.jpg' %}{% if logo_version %}?v={{ logo_version }}{% endif %}" alt="NeuroCare"
          class="logo-header">
      </a>
    </div>
    <nav>
      {% include 'includes/menu.html' %}
      <ul class="auth-links">
        {% if user.is_authenticated %}
        <li><a href="{% url 'profile' %}">Perfil</a></li>
        <li>
          <form method="post" action="{% url 'logout' %}" style="display:inline; margin:0;">
            {% csrf_token %}
            <button type="submit" class="link-button">Sair</button>
          </form>
        </li>
        {% else %}
        <li><a href="{% url 'login' %}">Entrar</a></li>
        {% endif %}
      </ul>
    </nav>
  </header>
  <main>
    {# hero removido: espaço do layout agora é controlado por .card e main #}
    <section class="card">
      {% block content %}{% endblock %}
    </section>
  </main>
  <!-- container para modais AJAX -->
  <div id="modal" class="modal-container" aria-hidden="true" style="display:none;"></div>
  <script src="{% static 'js/menu.js' %}{% if static_version %}?v={{ static_version }}{% endif %}"></script>
  <script src="{% static 'js/modal_ajax.js' %}{% if static_version %}?v={{ static_version }}{% endif %}"></script>
  <script>
    // Global modal delegation: ensures any modal content using data-modal-close works
    (function () {
      function getModal() { return document.getElementById('modal'); }
      function closeModal() { const m = getModal(); if (m) { m.style.display = 'none'; m.innerHTML = ''; } }

      document.addEventListener('click', function (e) {
        const m = getModal(); if (!m) return;
        // click on backdrop
        if (e.target === m) return closeModal();
        // click on any element (or ancestor) marked to close the modal
        if (e.target.closest && e.target.closest('[data-modal-close]')) return closeModal();
      });

      document.addEventListener('keydown', function (e) { if (e.key === 'Escape') closeModal(); });
    })();
  </script>
  {% block scripts %}{% endblock %}
</body>

</html>